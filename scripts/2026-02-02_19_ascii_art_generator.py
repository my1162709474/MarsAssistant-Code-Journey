#!/usr/bin/env python3
"""
ASCII Art Generator - Day 19
å°†å›¾ç‰‡ã€æ–‡æœ¬è½¬æ¢ä¸ºASCIIå­—ç¬¦ç”»

åŠŸèƒ½:
- å›¾ç‰‡è½¬ASCIIè‰ºæœ¯
- æ–‡æœ¬è½¬ASCIIè‰ºæœ¯
- å®žæ—¶æ‘„åƒå¤´è½¬ASCII (ç»ˆç«¯æ˜¾ç¤º)
- æ”¯æŒå¤šç§å­—ç¬¦é›†å’Œå¯¹æ¯”åº¦è°ƒæ•´
"""

import base64
import os
from PIL import Image
import io

# ASCIIå­—ç¬¦é›† (ä»Žæš—åˆ°äº®)
ASCII_CHARS = ['@', '#', '&', '%', 'W', '8', 'B', '$', 'M', 'H', 'b', 'd', 'p', 'q', 'w', 'm', 'Z', 'O', '0', 'z', 'o', '2', 'c', 'v', 'u', 'n', 'x', 'r', 'j', 'f', 't', '/', '\\', '|', '(', ')', '1', '?', '!', 'i', '>', '<', ':', ';', '"', ',', '.', ' ']
SIMPLE_CHARS = '@%#*+=-:. '


class ASCIIArtGenerator:
    """ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨"""
    
    def __init__(self, char_set='simple'):
        self.char_set = char_set
        self.chars = SIMPLE_CHARS if char_set == 'simple' else ASCII_CHARS
    
    def resize_image(self, image, new_width=100):
        """è°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œä¿æŒå®½é«˜æ¯”"""
        width, height = image.size
        ratio = height / width / 1.65  # 1.65æ˜¯å­—ç¬¦çš„é«˜å®½æ¯”ä¿®æ­£
        new_height = int(new_width * ratio)
        return image.resize((new_width, new_height))
    
    def grayscale_image(self, image):
        """è½¬æ¢ä¸ºç°åº¦å›¾"""
        return image.convert('L')
    
    def pixels_to_ascii(self, image):
        """å°†åƒç´ å€¼æ˜ å°„ä¸ºASCIIå­—ç¬¦"""
        pixels = image.getdata()
        chars = ''.join(self._pixel_to_char(p) for p in pixels)
        return chars
    
    def _pixel_to_char(self, pixel):
        """å•ä¸ªåƒç´ è½¬å­—ç¬¦"""
        if pixel < 25:
            return self.chars[0]
        elif pixel < 50:
            return self.chars[1]
        elif pixel < 75:
            return self.chars[2]
        elif pixel < 100:
            return self.chars[3]
        elif pixel < 125:
            return self.chars[4]
        elif pixel < 150:
            return self.chars[5]
        elif pixel < 175:
            return self.chars[6]
        elif pixel < 200:
            return self.chars[7]
        else:
            return self.chars[-1]
    
    def image_to_ascii(self, image_path, width=100, invert=False):
        """å›¾ç‰‡è½¬ASCII (ä¸»æ–¹æ³•)"""
        try:
            image = Image.open(image_path)
            image = self.resize_image(image, width)
            image = self.grayscale_image(image)
            
            if invert:
                image = Image.eval(image, lambda x: 255 - x)
            
            ascii_str = self.pixels_to_ascii(image)
            
            # æ¢è¡Œ
            ascii_art = ''
            for i in range(0, len(ascii_str), width):
                ascii_art += ascii_str[i:i+width] + '\n'
            
            return ascii_art
        except Exception as e:
            return f"é”™è¯¯: {e}"
    
    def text_to_ascii(self, text, font_size=8):
        """ç®€å•çš„æ–‡æœ¬è½¬ASCIIæ ‡é¢˜"""
        # é¢„å®šä¹‰çš„å¤§åž‹ASCIIå­—æ¯
        fonts = {
            'block': {
                'A': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ'],
                'B': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                'C': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                'D': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                'E': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                'F': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     '],
                'G': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                'H': ['â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ'],
                'I': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '   â–ˆâ–ˆ  ', '   â–ˆâ–ˆ  ', '   â–ˆâ–ˆ  ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                'J': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '    â–ˆâ–ˆ ', '    â–ˆâ–ˆ ', 'â–ˆâ–ˆ  â–ˆâ–ˆ ', ' â–ˆâ–ˆâ–ˆâ–ˆ  '],
                'K': ['â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ  â–ˆâ–ˆ ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ', 'â–ˆâ–ˆ  â–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ'],
                'L': ['â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                'M': ['â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆ', 'â–ˆâ–ˆ  â–ˆ  â–ˆâ–ˆ', 'â–ˆâ–ˆ      â–ˆâ–ˆ'],
                'N': ['â–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆ'],
                'O': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                'P': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆ     '],
                'Q': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ â–„â–„ â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€ '],
                'R': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ  â–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ'],
                'S': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                'T': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '   â–ˆâ–ˆ  ', '   â–ˆâ–ˆ  ', '   â–ˆâ–ˆ  ', '   â–ˆâ–ˆ  '],
                'U': ['â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                'V': ['â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ    â–ˆâ–ˆ', ' â–ˆâ–ˆ  â–ˆâ–ˆ ', '  â–ˆâ–ˆâ–ˆâ–ˆ  '],
                'W': ['â–ˆâ–ˆ    â–ˆâ–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ', ' â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ'],
                'X': ['â–ˆâ–ˆ    â–ˆâ–ˆ', ' â–ˆâ–ˆ  â–ˆâ–ˆ ', '  â–ˆâ–ˆâ–ˆâ–ˆ  ', ' â–ˆâ–ˆ  â–ˆâ–ˆ ', 'â–ˆâ–ˆ    â–ˆâ–ˆ'],
                'Y': ['â–ˆâ–ˆ    â–ˆâ–ˆ', ' â–ˆâ–ˆ  â–ˆâ–ˆ ', '  â–ˆâ–ˆâ–ˆâ–ˆ  ', '   â–ˆâ–ˆ  ', '   â–ˆâ–ˆ  '],
                'Z': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '    â–ˆâ–ˆ ', '   â–ˆâ–ˆ  ', '  â–ˆâ–ˆ   ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                '0': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ â–ˆ â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                '1': ['  â–ˆâ–ˆ  ', ' â–ˆâ–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', '  â–ˆâ–ˆ  ', ' â–ˆâ–ˆâ–ˆâ–ˆ '],
                '2': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
                '3': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                '4': ['â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '      â–ˆâ–ˆ', '      â–ˆâ–ˆ'],
                '5': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', '     â–ˆâ–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                '6': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆâ–ˆ     ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                '7': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '     â–ˆâ–ˆ', '    â–ˆâ–ˆ ', '   â–ˆâ–ˆ  ', '  â–ˆâ–ˆ   '],
                '8': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                '9': [' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆâ–ˆ   â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '      â–ˆâ–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ '],
                ' ': ['  ', '  ', '  ', '  ', '  '],
                '!': ['â–ˆâ–ˆ', 'â–ˆâ–ˆ', 'â–ˆâ–ˆ', '  ', 'â–ˆâ–ˆ'],
                '.': ['  ', '  ', '  ', '  ', 'â–ˆâ–ˆ'],
            }
        }
        
        font = fonts.get('block', {})
        lines = ['' for _ in range(5)]
        
        for char in text.upper():
            if char in font:
                for i in range(5):
                    lines[i] += font[char][i]
            else:
                for i in range(5):
                    lines[i] += '  ' * len(char)
        
        return '\n'.join(lines)


def demo():
    """æ¼”ç¤º"""
    generator = ASCIIArtGenerator()
    
    # æ ‡é¢˜
    print('\n' + "=" * 50)
    print("ðŸŽ¨ ASCII Art Generator - Day 19")
    print("=" * 50 + '\n')
    
    # æ–‡æœ¬è½¬ASCIIæ¼”ç¤º
    print("ðŸ“ æ–‡æœ¬è½¬ASCIIç¤ºä¾‹:")
    print("-" * 30)
    title = generator.text_to_ascii("HELLO")
    print(title)
    print()
    
    # å°è¯•è½¬æ¢ä¸€å¼ å›¾ç‰‡
    print("ðŸ–¼ï¸ å›¾ç‰‡è½¬ASCIIç¤ºä¾‹:")
    print("-" * 30)
    print("(è¯·æä¾›å›¾ç‰‡è·¯å¾„ï¼Œæˆ–ä½¿ç”¨å†…ç½®æµ‹è¯•)")
    print()
    
    # å¯ç”¨å­—ç¬¦é›†
    print("ðŸ“¦ å¯ç”¨å­—ç¬¦é›†: simple, full")
    print("ðŸ”§ ä½¿ç”¨æ–¹æ³•:")
    print("  generator = ASCIIArtGenerator(char_set='full')")
    print("  ascii_art = generator.image_to_ascii('photo.jpg', width=80)")
    print()


if __name__ == '__main__':
    demo()
